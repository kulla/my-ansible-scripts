---
- tags: [ vim ]
  block:
    - name: Install vim
      package: name=vim-gtk state=present

    - name: Configure vim
      copy:
        src: vimrc
        dest: "{{ user.homedir}}/.vimrc"
        mode: 0600
        owner: "{{ user.name }}"
        group: "{{ user.group }}"

    - name: Create directory for .swp files
      file:
        path: "{{ user.homedir}}/.vim/tmp"
        state: directory
        owner: "{{ user.name }}"
        group: "{{ user.group }}"
        mode: 0700

    - name: Make vim the default text editor
      copy:
        src: set_default_text_editor.sh
        dest: "{{ shell_conf_dir }}/profile"
        mode: 0700
        owner: "{{ user.name }}"
        group: "{{ user.group }}"

    - name: Install vim plugins
      package:
        name:
          - vim-syntastic
          - vim-editorconfig
          - pep8
          - pylint
          - pyflakes
        state: present

    - name: Enable vim plugins
      command: vim-addons install editorconfig
      args:
        creates: "{{ user.homedir }}/.vim/autoload/editorconfig.vim"
